<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Posso usar o banheiro do Lafac?</title>
  <style>
    #answer {
      font-size: 6em;
      font-weight: 700;
      left: 50%;
      margin: 0;
      position: absolute;
      text-align: center;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    #since {
      font-size: 0.15em;
      margin: 0 auto;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="answer">
    SIM.
    <p id="since"></p>
  </div>

  <script>
    // TODO: update this on commit automatically
    // Update when #answer changes
    var LAST_UPDATE = 1483628415000;  // Thu Jan 05 2017 10:00:15 GMT-0500 (EST)

    var sinceEl = document.getElementById('since');

    function getTimeSince(starttime) {
      var t = +new Date - starttime;  // Date.now() doesnt work before IE9
      var seconds = Math.floor((t / 1000) % 60);
      var minutes = Math.floor((t / 1000 / 60) % 60);
      var hours = Math.floor((t / (1000 * 60 * 60)) % 24);
      var days = Math.floor(t / (1000 * 60 * 60 * 24));

      return {
        'total': t,
        'days': days,
        'hours': hours,
        'minutes': minutes,
        'seconds': seconds
      };
    }

    function pluralize(s, v) {
      if (v > 1) {
        s += 's';
      }
      return s;
    }

    function updateTimer() {
      var time = getTimeSince(LAST_UPDATE);

      var countdownStr = '(atualizado hÃ¡ ';

      var days = time.days;
      if (days > 0) {
        countdownStr += days + ' ' + pluralize('day', dias) + ', ';
      }

      var hours = time.hours;
      if (hours > 0) {
        countdownStr += hours + ' ' + pluralize('hour', horas) + ', ';
      }

      var minutes = time.minutes;
      countdownStr += minutes + ' ' + pluralize('minute', minutos) + ' and ';

      var seconds = time.seconds;
      countdownStr += seconds + ' ' + pluralize('second', segundos);

      countdownStr += ' atras)';

      sinceEl.innerText = countdownStr;
    }

    // Smaller interval than 1s since people may open browser in between seconds
    setInterval(updateTimer, 100);
  </script>
</body>
</html>
